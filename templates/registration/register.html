{% extends 'base.html' %}

{% block title %}Sign Up - GCP Study Plan{% endblock %}

{% block navbar %}{% endblock %}
{% block footer %}{% endblock %}

{% block content %}
<div class="fixed inset-0 w-full h-full bg-slate-50 overflow-y-auto">
    <!-- Subtle Gradient Background to fill the rest -->
    <div class="fixed inset-0 bg-gradient-to-br from-indigo-50/50 via-white to-blue-50/50 z-0"></div>
    <div class="fixed top-[-10%] left-[-10%] w-[40%] h-[40%] bg-brand-100/50 rounded-full blur-[80px] z-0"></div>
    <div class="fixed bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-indigo-100/50 rounded-full blur-[80px] z-0"></div>

    <!-- Main Container -->
    <div class="relative z-10 min-h-screen flex flex-col items-center justify-center p-4">

        <!-- Header (Logo Only) -->
        <div class="mb-8 text-center">
            <div class="min-h-screen w-full flex bg-white">

                <!-- LEFT SIDE: 3D Mission Briefing -->
                <div
                    class="hidden lg:flex w-1/2 bg-slate-900 relative overflow-hidden flex-col justify-between p-12 text-white">
                    <!-- Abstract Background -->
                    <div
                        class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10">
                    </div>
                    <div
                        class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-brand-600 rounded-full blur-[100px] opacity-20">
                    </div>

                    <!-- Brand -->
                    <div class="relative z-10 flex items-center gap-3">
                        <div class="w-10 h-10 bg-brand-600 rounded-xl flex items-center justify-center">
                            <i class="fa-brands fa-google text-2xl text-white"></i>
                        </div>
                        <span class="text-2xl font-bold tracking-tight">GCP<span
                                class="text-brand-400">Mastery</span></span>
                    </div>

                    <!-- 3D Content -->
                    <div class="relative z-10 space-y-6 max-w-lg">
                        <h1 class="text-5xl font-black leading-tight">
                            Become a <br />
                            <span
                                class="text-transparent bg-clip-text bg-gradient-to-r from-brand-400 to-indigo-400">Cloud
                                Architect</span>
                        </h1>
                        <p class="text-slate-400 text-lg leading-relaxed">
                            Join the elite training program designed to take you from beginner to certified GCP
                            Associate in 45 days.
                        </p>

                        <div class="flex gap-4 pt-4">
                            <div class="flex -space-x-4">
                                <div class="w-10 h-10 rounded-full bg-slate-700 border-2 border-slate-900"></div>
                                <div class="w-10 h-10 rounded-full bg-slate-600 border-2 border-slate-900"></div>
                                <div class="w-10 h-10 rounded-full bg-slate-500 border-2 border-slate-900"></div>
                            </div>
                            <div class="flex items-center text-sm font-bold text-slate-300">
                                +1,200 Cadets Enrolled
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="relative z-10 text-xs text-slate-500">
                        &copy; 2025 Antigravity. All systems go.
                    </div>
                </div>

                <!-- RIGHT SIDE: Auth Form -->
                <div class="w-full lg:w-1/2 flex items-center justify-center p-8 lg:p-12 relative flex-col">
                    <div class="max-w-md w-full space-y-8">
                        <div class="text-center lg:text-left">
                            <h2 class="text-3xl font-extrabold text-slate-900">Initialize Account</h2>
                            <p class="mt-2 text-slate-600">Enter your credentials to begin the simulation.</p>
                        </div>

                        <!-- Handle Form Errors Globally -->
                        <form method="post" id="registerForm" novalidate>
                            {% csrf_token %}
                            {% if form.errors %}
                            <div
                                class="mb-6 p-4 rounded-xl bg-red-50 border border-red-100 text-red-600 text-sm animate-pulse-slow">
                                <p class="font-bold flex items-center gap-2"><i
                                        class="fa-solid fa-triangle-exclamation"></i> Action Required</p>
                                <div class="mt-1 pl-6">
                                    {% for field in form %}
                                    {% for error in field.errors %}
                                    <li>{{ field.label }}: {{ error }}</li>
                                    {% endfor %}
                                    {% endfor %}
                                    {% for error in form.non_field_errors %}
                                    <li>{{ error }}</li>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}

                            <div class="space-y-5">
                                <!-- Username Field -->
                                <div class="relative group">
                                    <input type="text" name="username" id="id_username" required
                                        class="peer block w-full px-4 py-3.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500 focus:border-transparent transition bg-slate-50 text-slate-900 placeholder-transparent"
                                        placeholder="Username" value="{{ form.username.value|default:'' }}">
                                    <label for="id_username"
                                        class="absolute left-4 top-3.5 text-slate-500 text-sm transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-placeholder-shown:top-3.5 peer-focus:-top-2 peer-focus:text-xs peer-focus:text-brand-600 peer-focus:bg-white peer-focus:px-1 pointer-events-none bg-transparent">
                                        Username
                                    </label>
                                    <p id="err_username"
                                        class="hidden mt-1 text-xs font-bold text-red-500 flex items-center gap-1">
                                        <i class="fa-solid fa-circle-exclamation"></i> Username is required
                                    </p>
                                </div>

                                <!-- Email Field -->
                                <div class="relative group">
                                    <input type="email" name="email" id="id_email"
                                        class="peer block w-full px-4 py-3.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500 focus:border-transparent transition bg-slate-50 text-slate-900 placeholder-transparent"
                                        placeholder="Email Address" value="{{ form.email.value|default:'' }}">
                                    <label for="id_email"
                                        class="absolute left-4 top-3.5 text-slate-500 text-sm transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-placeholder-shown:top-3.5 peer-focus:-top-2 peer-focus:text-xs peer-focus:text-brand-600 peer-focus:bg-white peer-focus:px-1 pointer-events-none bg-transparent">
                                        Email Address (Optional)
                                    </label>
                                </div>

                                <!-- Passwords Grid -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                    <!-- Password 1 -->
                                    <div class="relative group">
                                        <input type="password" name="password1" id="id_password1" required
                                            class="peer block w-full px-4 py-3.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500 focus:border-transparent transition bg-slate-50 text-slate-900 placeholder-transparent">
                                        <label for="id_password1"
                                            class="absolute left-4 top-3.5 text-slate-500 text-sm transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-placeholder-shown:top-3.5 peer-focus:-top-2 peer-focus:text-xs peer-focus:text-brand-600 peer-focus:bg-white peer-focus:px-1 pointer-events-none bg-transparent">
                                            Password
                                        </label>
                                        <p id="err_password1"
                                            class="hidden mt-1 text-xs font-bold text-red-500 flex items-center gap-1">
                                            <i class="fa-solid fa-circle-exclamation"></i> Required
                                        </p>

                                        <!-- Help Tooltip -->
                                        <div
                                            class="hidden peer-focus:block absolute z-20 left-0 top-full mt-2 w-64 bg-slate-800 text-white text-[10px] p-3 rounded-lg shadow-xl opacity-0 peer-focus:opacity-100 transition-opacity duration-200 pointer-events-none">
                                            <i class="fa-solid fa-shield-halved mr-1 text-brand-400"></i> Minimum 8
                                            chars,
                                            mixed case & numbers.
                                        </div>
                                    </div>

                                    <!-- Password 2 -->
                                    <div class="relative group">
                                        <input type="password" name="password2" id="id_password2" required
                                            class="peer block w-full px-4 py-3.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500 focus:border-transparent transition bg-slate-50 text-slate-900 placeholder-transparent">
                                        <label for="id_password2"
                                            class="absolute left-4 top-3.5 text-slate-500 text-sm transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-placeholder-shown:top-3.5 peer-focus:-top-2 peer-focus:text-xs peer-focus:text-brand-600 peer-focus:bg-white peer-focus:px-1 pointer-events-none bg-transparent">
                                            Confirm
                                        </label>
                                        <p id="err_password2"
                                            class="hidden mt-1 text-xs font-bold text-red-500 flex items-center gap-1">
                                            <i class="fa-solid fa-circle-exclamation"></i> Required
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <button type="submit"
                                class="w-full mt-8 bg-slate-900 hover:bg-brand-600 text-white font-bold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 flex items-center justify-center gap-2 text-sm uppercase tracking-wide">
                                <span>Initialize System</span>
                                <i class="fa-solid fa-arrow-right-long"></i>
                            </button>
                        </form>

                        <!-- Custom Animation Styles -->
                        <style>
                            @keyframes shake {

                                0%,
                                100% {
                                    transform: translateX(0);
                                }

                                25% {
                                    transform: translateX(-5px);
                                }

                                75% {
                                    transform: translateX(5px);
                                }
                            }

                            .animate-shake {
                                animation: shake 0.3s ease-in-out;
                            }
                        </style>

                        <script>
                            document.getElementById('registerForm').addEventListener('submit', function (e) {
                                const fields = [
                                    { input: document.getElementById('id_username'), msg: document.getElementById('err_username') },
                                    { input: document.getElementById('id_password1'), msg: document.getElementById('err_password1') },
                                    { input: document.getElementById('id_password2'), msg: document.getElementById('err_password2') }
                                ];

                                let hasError = false;

                                fields.forEach(({ input, msg }) => {
                                    // Reset state
                                    input.classList.remove('animate-shake');
                                    void input.offsetWidth; // Trigger reflow for restart animation

                                    if (!input.value.trim()) {
                                        hasError = true;
                                        input.classList.add('ring-2', 'ring-red-500', 'bg-red-50', 'animate-shake');
                                        if (msg) msg.classList.remove('hidden');

                                        // Auto-clear on input
                                        input.addEventListener('input', function () {
                                            if (this.value.trim()) {
                                                this.classList.remove('ring-2', 'ring-red-500', 'bg-red-50');
                                                if (msg) msg.classList.add('hidden');
                                            }
                                        }, { once: true });
                                    }
                                });

                                if (hasError) {
                                    e.preventDefault();
                                    // Toast removed by user request
                                }
                            });
                        </script>

                        <!-- Footer -->
                        <div class="mt-8 pt-6 border-t border-slate-100 text-center">
                            <p class="text-sm text-slate-500">
                                Already have an account?
                                <a href="{% url 'login' %}"
                                    class="text-brand-600 font-bold hover:text-brand-700 transition-colors">Log in</a>
                            </p>
                        </div>
                    </div>

                    <!-- Bottom Links -->
                    <div class="mt-8 text-center space-x-6 relative z-10">
                        <a href="#"
                            class="text-xs text-slate-400 hover:text-slate-600 font-medium transition-colors">Privacy
                            Policy</a>
                        <a href="#"
                            class="text-xs text-slate-400 hover:text-slate-600 font-medium transition-colors">Terms of
                            Service</a>
                        <a href="#"
                            class="text-xs text-slate-400 hover:text-slate-600 font-medium transition-colors">Help
                            Center</a>
                    </div>
                </div>
            </div>
            {% endblock %}